(this["webpackJsonprealtime-chat"]=this["webpackJsonprealtime-chat"]||[]).push([[0],{106:function(e,t,a){},109:function(e,t,a){"use strict";a.r(t);var s=a(0),r=a.n(s),n=a(10),c=a.n(n),i=(a(97),a(12)),o=a(13),l=a(15),d=a(14),u=a(20),h=a(17),j=a(11),p=a(5),b=a(1),m=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={email:"",password:""},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return Object(b.jsx)("div",{className:"container",children:Object(b.jsx)("div",{className:"row",children:Object(b.jsx)("div",{className:"col-md-12",children:Object(b.jsxs)("div",{className:"form-wrapper",children:[Object(b.jsx)("h1",{children:"Login"}),Object(b.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e.props.chat.socket&&e.props.chat.socket.send(JSON.stringify({type:"LOGIN",data:{email:e.state.email,password:e.state.password}}))},children:[Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"Email"}),Object(b.jsx)("input",{type:"email",className:"form-control",placeholder:"Email",value:this.state.email,onChange:function(t){e.setState({email:t.target.value})}})]}),Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"Password"}),Object(b.jsx)("input",{type:"password",className:"form-control",placeholder:"Password",value:this.state.password,onChange:function(t){e.setState({password:t.target.value})}})]}),Object(b.jsxs)("p",{children:["Don't have an account yet? ",Object(b.jsx)(u.b,{to:"/signup",children:"Sign up"})]}),Object(b.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Sign in"})]})]})})})})}}]),a}(s.Component),O=Object(j.b)((function(e){return{auth:e.auth,chat:e.chat}}),(function(e){return{}}))(m),f=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={email:"",password:"",passwordAgain:"",name:"",username:"",error:"error"},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return Object(b.jsx)("div",{className:"container",children:Object(b.jsx)("div",{className:"row",children:Object(b.jsx)("div",{className:"col-md-12",children:Object(b.jsxs)("div",{className:"form-wrapper",children:[Object(b.jsx)("h1",{children:"Signup"}),Object(b.jsxs)("form",{onSubmit:function(t){if(t.preventDefault(),e.props.chat.socket){var a=0;if(Object.keys(e.state).forEach((function(t){""===e.state[t]&&(a+=1)})),a>0)return e.setState({error:"All Fields Required"});if(e.state.password!==e.state.passwordAgain)return e.setState({error:"Passwords Must Match"});e.props.chat.socket.send(JSON.stringify({type:"SIGNUP",data:{email:e.state.email,password:e.state.password,name:e.state.name,username:e.state.username}}))}},children:[Object(b.jsxs)("div",{className:"row",children:[Object(b.jsx)("div",{className:"col-md-6",children:Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"Name"}),Object(b.jsx)("input",{type:"text",className:"form-control",placeholder:"Name",value:this.state.name,onChange:function(t){e.setState({name:t.target.value})}})]})}),Object(b.jsx)("div",{className:"col-md-6",children:Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"Username"}),Object(b.jsx)("input",{type:"text",className:"form-control",placeholder:"Username",value:this.state.username,onChange:function(t){e.setState({username:t.target.value})}})]})}),Object(b.jsx)("div",{className:"col-md-6",children:Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"Email"}),Object(b.jsx)("input",{type:"email",className:"form-control",placeholder:"Email",value:this.state.email,onChange:function(t){e.setState({email:t.target.value})}})]})})]}),Object(b.jsxs)("div",{className:"row",children:[Object(b.jsx)("div",{className:"col-md-6",children:Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"Password"}),Object(b.jsx)("input",{type:"password",className:"form-control",placeholder:"Password",value:this.state.password,onChange:function(t){e.setState({password:t.target.value})}})]})}),Object(b.jsx)("div",{className:"col-md-6",children:Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"Password (Again)"}),Object(b.jsx)("input",{type:"password",className:"form-control",placeholder:"Password",value:this.state.passwordAgain,onChange:function(t){e.setState({passwordAgain:t.target.value})}})]})})]}),Object(b.jsxs)("p",{children:["Already have an account? ",Object(b.jsx)(u.b,{to:"/login",children:"Sign in"})]}),Object(b.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Sign up"}),this.state.error&&"error"!==this.state.error?Object(b.jsx)("p",{className:"text-danger error-message",children:this.state.error}):null]})]})})})})}}]),a}(s.Component),x=Object(j.b)((function(e){return{auth:e.auth,chat:e.chat}}),(function(e){return{}}))(f),g=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return Object(b.jsx)("div",{className:"auth-wrapper",children:"/signup"===this.props.match.path?Object(b.jsx)(x,{}):Object(b.jsx)(O,{})})}}]),a}(s.Component),v=Object(j.b)((function(e){return Object(p.a)({},e.auth)}))(Object(h.g)(g)),y=a(149),N=a(74),E=a.n(N),A=a(52),S=a.n(A),T=a(22),D=a.n(T),I=a(75),w=a.n(I),k=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={search:"",solo:!0},e.search=function(){e.props.chat.socket.send(JSON.stringify({type:"SEARCH",data:e.state.search}))},e.findOrCreateThread=function(t){e.props.chat.socket.send(JSON.stringify({type:"FIND_THREAD",data:[e.props.auth.user,t]})),e.setState({search:""})},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return Object(b.jsxs)("div",{className:"sidebar",children:[Object(b.jsxs)("div",{className:"search-container",children:[Object(b.jsx)("input",{className:"form-control",placeholder:"Search for people...",value:this.state.search,onChange:function(t){e.setState({search:t.target.value})}}),Object(b.jsx)("button",{className:"search-button",onClick:function(t){return e.search()},children:Object(b.jsx)(E.a,{})})]}),Object(b.jsxs)("div",{className:"sidebar-bar",children:[Object(b.jsx)("button",{className:"sidebar-button ".concat(!this.state.solo&&"unselected"),onClick:function(t){return e.setState({solo:!0})},children:"People"}),Object(b.jsx)("button",{className:"sidebar-button ".concat(this.state.solo&&"unselected"),onClick:function(t){return e.setState({solo:!1})},children:"Groups"})]}),this.state.search?Object(b.jsxs)("ul",{className:"thread-list",children:[Object(b.jsx)("label",{children:"Results"}),this.props.chat.users&&this.props.chat.users.filter((function(t){return t.id!==e.props.auth.user.id})).map((function(t,a){return Object(b.jsx)("li",{children:Object(b.jsxs)("div",{onClick:function(a){a.preventDefault(),console.log(t),e.findOrCreateThread(t)},children:[Object(b.jsx)("i",{className:"zmdi zmdi-account-circle"}),Object(b.jsx)("h5",{className:"title",children:t.name}),Object(b.jsx)("p",{children:"Click to Write a message"})]})},a)}))]}):this.state.solo?Object(b.jsxs)("ul",{className:"thread-list",children:[Object(b.jsx)("label",{children:"Messages"}),this.props.chat.threads&&this.props.chat.threads.map((function(t,a){if(t.users.length<3)return Object(b.jsx)("li",{children:Object(b.jsxs)(u.b,{to:"/".concat(t.id),style:{display:"flex",flexDirection:"row"},children:[t.profiles&&""!==t.profiles.filter((function(t){return t.userId!==e.props.auth.user.id}))[0].avatar?Object(b.jsx)(y.a,{className:"sidebar-avatar",src:t.profiles.filter((function(t){return t.userId!==e.props.auth.user.id}))[0].avatar}):Object(b.jsx)(y.a,{className:"sidebar-avatar",children:Object(b.jsx)(D.a,{})}),Object(b.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(b.jsx)("h5",{className:"title",children:t.users?t.users.filter((function(t){return t.userId!==e.props.auth.user.id}))[0].username:""}),Object(b.jsx)("p",{children:t.Messages&&t.Messages[0]?t.Messages[t.Messages.length-1].picture?"Picture sended":t.Messages[t.Messages.length-1].content.length>27?t.Messages[t.Messages.length-1].content.substring(0,27)+"...":t.Messages[t.Messages.length-1].content:"No Messages"})]})]})},a)})),Object(b.jsxs)(u.b,{to:"/account",style:{color:"black"},className:"account-settings",children:[Object(b.jsx)(S.a,{className:"settings-icon"}),Object(b.jsx)("span",{style:{marginLeft:"5px"},children:"Account Settings"})]})]}):Object(b.jsxs)("ul",{className:"thread-list",children:[Object(b.jsx)("label",{children:"Groups"}),Object(b.jsx)("li",{children:Object(b.jsxs)(u.b,{to:"/create-group",style:{display:"flex",flexDirection:"row"},children:[Object(b.jsx)(y.a,{className:"sidebar-avatar",children:Object(b.jsx)(w.a,{})}),Object(b.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(b.jsx)("h5",{className:"title",children:"Create a Group"}),Object(b.jsx)("p",{children:"Click here!"})]})]})}),this.props.chat.threads&&this.props.chat.threads.map((function(e,t){if(e.users.length>2)return Object(b.jsx)("li",{children:Object(b.jsxs)(u.b,{to:"/".concat(e.id),style:{display:"flex",flexDirection:"row"},children:[""!==e.image?Object(b.jsx)(y.a,{className:"sidebar-avatar",src:e.image}):Object(b.jsx)(y.a,{className:"sidebar-avatar",children:Object(b.jsx)(D.a,{})}),Object(b.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(b.jsx)("h5",{className:"title",children:e.name?e.name.length>24?e.name.substring(0,e.name.length-6)+"...":e.name:""}),Object(b.jsx)("p",{children:e.Messages&&e.Messages[0]?e.Messages[e.Messages.length-1].picture?"Picture sent":e.Messages[e.Messages.length-1].content.length>27?e.Messages[e.Messages.length-1].content.substring(0,27)+"...":e.Messages[e.Messages.length-1].content:"No Messages"})]})]})},t)})),Object(b.jsxs)(u.b,{to:"/account",style:{color:"black"},className:"account-settings",children:[Object(b.jsx)(S.a,{className:"settings-icon"}),Object(b.jsx)("span",{style:{marginLeft:"5px"},children:"Account Settings"})]})]})]})}}]),a}(s.Component),C=Object(j.b)((function(e){return{auth:e.auth,chat:e.chat}}),(function(e){return{}}))(Object(h.g)(k)),_=a(46),R=a.n(_),M=a(6),P=a(144),G=a(148),L=a(150),H=a(146),U=a(78),F=a.n(U),J=a(79),W=a.n(J),B=a(147),V=a(47),K=a.n(V),q=a(145),z=a(77),Y=a.n(z),Q=a(59),X=a.n(Q),Z=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).dateFormat=function(){var t=Date.parse(e.props.message.date);return Intl.DateTimeFormat("pl-PL",{year:"numeric",month:"numeric",day:"numeric"}).format(t)===Intl.DateTimeFormat("pl-PL",{year:"numeric",month:"numeric",day:"numeric"}).format(new Date)?Intl.DateTimeFormat("pl-PL",{hour:"numeric",minute:"numeric"}).format(t):Intl.DateTimeFormat("pl-PL",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"}).format(t)},e}return Object(o.a)(a,[{key:"render",value:function(){return Object(b.jsxs)("div",{className:"message-item ".concat(this.props.message.userId===this.props.auth.user.id?"msg-right":"msg-left"),children:[this.props.profile&&""===this.props.profile?Object(b.jsx)(y.a,{className:"message-icon",children:Object(b.jsx)(D.a,{})}):Object(b.jsx)(y.a,{src:this.props.profile.avatar,className:"message-icon"}),Object(b.jsx)("div",{className:"username-text",children:this.props.user.userId===this.props.auth.user.Profile.userId?null:this.props.user.username}),this.props.message.picture?Object(b.jsx)("img",{className:"chat-image",title:this.dateFormat(),src:this.props.message.content,alt:"message"}):Object(b.jsxs)("div",{className:"chat-bubble",title:this.dateFormat(),"data-toggle":"tooltip",children:[this.props.message.content," "]})]})}}]),a}(s.Component),$=Object(j.b)((function(e){return{auth:e.auth,chat:e.chat}}))(Z),ee=a(76),te=a.n(ee),ae=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={content:"",picture:!1},e.tobase64=function(t){var a=new FileReader;a.readAsDataURL(t),a.onload=function(){e.setState({content:a.result,picture:!0}),e.sendMessage()}},e.compression=function(t){new R.a(t,{quality:.6,success:function(t){e.tobase64(t)}})},e.sendMessage=function(){var t={threadId:e.props.match.params.threadId,userId:e.props.auth.user.id,content:e.state.content,date:new Date,picture:e.state.picture};try{e.props.chat.socket.send(JSON.stringify({type:"ADD_MESSAGE",threadId:t.threadId,message:t}))}catch(a){}e.setState({content:"",picture:!1})},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return Object(b.jsx)("form",{className:"input-view",onSubmit:function(t){t.preventDefault(),e.sendMessage()},children:Object(b.jsxs)("div",{className:"input-group",children:[Object(b.jsx)("input",{type:"text",placeholder:"Write your message",className:"form-control",value:this.state.content,onChange:function(t){return e.setState({content:t.target.value})}}),Object(b.jsxs)("label",{style:{position:"fixed",marginLeft:"2px"},children:[Object(b.jsx)(X.a,{className:"input-image"}),Object(b.jsx)("input",{className:"MyFile",type:"file",onChange:function(t){return e.compression(t.target.files[0])},id:"file-input-thread",style:{opacity:"0",width:"0",height:"0"}})]}),Object(b.jsx)("button",{className:"send-button",type:"submit",children:Object(b.jsx)(te.a,{})})]})})}}]),a}(s.Component),se=Object(j.b)((function(e){return{auth:e.auth,chat:e.chat}}),(function(e){return{toBase64:function(t){e(function(e){var t=e,a=new FileReader;a.readAsDataURL(t.files[0]),a.onload=function(){return a.result}}(t))}}}))(Object(h.g)(ae)),re=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={settings:!1,nicknames:!1,nicknameEdit:-1,newNick:"",userId:"",threadNameChange:!1,newThreadName:"",solo:!0,showThreadView:!0},e.init=function(){var t=e.props.chat.threads?e.props.chat.threads.filter((function(t){return t.id===e.props.match.params.threadId}))[0]:null;if(t&&e.props.chat.socket){var a=t.Messages||0;try{e.props.chat.socket.send(JSON.stringify({type:"THREAD_LOAD",data:{threadId:e.props.match.params.threadId,skip:a}}))}catch(s){}}t&&e.props.setCurrentThread(t),t&&t.users.length>2?e.setState({solo:!1}):e.setState({solo:!0})},e.handleClick=function(){e.setState({nicknames:!e.state.nicknames})},e.nickChanged=function(){e.props.chat.socket.send(JSON.stringify({type:"THREAD_NICK_CHANGED",threadId:e.props.match.params.threadId,newNick:e.state.newNick,userId:e.state.userId})),e.setState({nicknameEdit:-1,newNick:""})},e.threadNameChanged=function(){e.setState({threadNameChange:!1}),e.props.chat.socket.send(JSON.stringify({type:"THREAD_NAME_CHANGED",threadId:e.props.match.params.threadId,newThreadName:e.state.newThreadName}))},e.threadAvatarChanged=function(t){e.props.chat.socket.send(JSON.stringify({type:"THREAD_AVATAR_CHANGED",avatar:t,threadId:e.props.match.params.threadId}))},e.tobase64=function(t){var a=new FileReader;a.readAsDataURL(t),a.onload=function(){e.threadAvatarChanged(a.result)}},e.compression=function(t){new R.a(t,{quality:.4,success:function(t){e.tobase64(t)}})},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(e){this.init(),this.setState({showThreadView:"/"!==this.props.match.url})}},{key:"componentDidUpdate",value:function(e){e.match.params.threadId!==this.props.match.params.threadId&&this.init(),e.match.url!==this.props.match.url&&this.setState({showThreadView:"/"!==this.props.match.url})}},{key:"render",value:function(){var e=this,t=this.props;return Object(b.jsx)("div",{children:this.state.showThreadView?Object(b.jsxs)("div",{children:[Object(b.jsxs)("div",{className:"thread-top-bar",children:[Object(b.jsxs)("div",{style:{marginLeft:"10px",display:"flex",justifyContent:"flex-start",flexDirection:"row"},children:[this.state.solo?!this.state.settings&&this.props.chat.currentThread&&Object(b.jsx)(y.a,{className:"thread-avatar",src:this.props.chat.currentThread.profiles&&this.props.chat.currentThread.profiles.filter((function(t){return t.userId!==e.props.auth.user.id}))[0].avatar,children:Object(b.jsx)(D.a,{})}):Object(b.jsx)("div",{children:this.props.chat.currentThread&&this.props.chat.currentThread.image?Object(b.jsx)(y.a,{src:this.props.chat.currentThread.image,className:"thread-avatar"}):Object(b.jsx)(y.a,{className:"thread-avatar",children:Object(b.jsx)(D.a,{})})}),Object(b.jsx)("div",{className:"thread-title",children:this.state.settings?"Settings":this.props.chat.currentThread?this.state.solo?this.props.chat.currentThread.users&&this.props.chat.currentThread.users.filter((function(t){return t.userId!==e.props.auth.user.id}))[0].username:this.props.chat.currentThread.name:"Chat"})]}),Object(b.jsx)("div",{className:"icons",children:Object(b.jsx)(S.a,{onClick:function(t){return e.setState({settings:!e.state.settings})}})})]}),this.state.settings?Object(b.jsx)("div",{className:"settings-view",children:Object(b.jsxs)(P.a,{component:"nav","aria-labelledby":"nested-list-subheader",className:t.root,children:[!this.state.solo&&Object(b.jsx)(G.a,{button:!0,children:this.state.threadNameChange?Object(b.jsx)("form",{onSubmit:function(t){return e.threadNameChanged()},children:Object(b.jsx)(B.a,{id:"standard-basic",label:this.props.chat.threads.filter((function(t){return t.id===e.props.match.params.threadId})).name,onChange:function(t){return e.setState({newThreadName:t.target.value})}})}):Object(b.jsxs)("div",{style:{display:"inline-flex",flexDirection:"row",justifyContent:"space-between",width:"100%"},onClick:function(t){return e.setState({threadNameChange:!0})},children:[Object(b.jsx)(q.a,{children:Object(b.jsx)(K.a,{})}),Object(b.jsx)(L.a,{primary:"Change Conversation's name"})]})}),!this.state.solo&&Object(b.jsx)(G.a,{button:!0,children:Object(b.jsxs)("label",{style:{display:"flex",flexDirection:"row",height:"24px",alignItems:"center"},children:[Object(b.jsx)("input",{className:"MyFile",type:"file",onChange:function(t){return e.compression(t.target.files[0])},id:"file-input-thread",style:{opacity:"0",width:"0",height:"0"}}),Object(b.jsx)(q.a,{children:Object(b.jsx)(X.a,{})}),Object(b.jsx)(L.a,{primary:"Change Conversation's avatar"})]})}),Object(b.jsxs)(G.a,{button:!0,onClick:function(t){return e.handleClick()},children:[Object(b.jsx)(q.a,{children:Object(b.jsx)(Y.a,{})}),Object(b.jsx)(L.a,{primary:"Nicknames"}),this.state.nicknames?Object(b.jsx)(F.a,{}):Object(b.jsx)(W.a,{})]}),Object(b.jsx)(H.a,{in:this.state.nicknames,timeout:"auto",unmountOnExit:!0,children:Object(b.jsx)(P.a,{component:"div",disablePadding:!0,children:this.state.nicknames?this.props.chat.currentThread.users.map((function(a,s){return Object(b.jsxs)(G.a,{button:!0,className:t.nested,onClick:function(t){e.setState({nicknameEdit:s})},children:[e.props.chat.currentThread.profiles&&""===e.props.chat.currentThread.profiles.filter((function(e){return e.userId===a.userId}))[0].avatar?Object(b.jsx)(y.a,{className:"settings-nickname-icon",children:Object(b.jsx)(D.a,{})}):Object(b.jsx)(y.a,{className:"settings-nickname-icon",src:e.props.chat.currentThread.profiles.filter((function(e){return e.userId===a.userId}))[0].avatar}),e.state.nicknameEdit===s?Object(b.jsx)("form",{onSubmit:function(t){return e.nickChanged()},children:Object(b.jsx)(B.a,{id:"standard-basic",label:a.username,onChange:function(t){return e.setState({newNick:t.target.value,userId:a.userId})}})}):Object(b.jsxs)("div",{style:{display:"inline-flex",flexDirection:"row",justifyContent:"space-between",width:"100%"},children:[Object(b.jsx)(L.a,{primary:a.username}),Object(b.jsx)(q.a,{children:Object(b.jsx)(K.a,{})})]})]},s)})):null})})]})}):Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:"main-view",id:"main-view",children:Object(b.jsx)("div",{className:"message-container",children:this.props.chat.currentThread.Messages?this.props.chat.currentThread.Messages.map((function(t,a){return Object(b.jsx)($,{message:t,profile:e.props.chat.currentThread.profiles.filter((function(e){return t.userId===e.userId}))[0],user:e.props.chat.currentThread.users.filter((function(e){return e.userId===t.userId}))[0]},a)})):null})}),Object(b.jsx)(se,{})]})]}):Object(b.jsxs)("div",{className:"title-screen",children:[Object(b.jsx)("h5",{className:"title",children:"Welcome to the ReactMess!"}),Object(b.jsx)("img",{style:{width:"200px"},src:"https://cdn.pixabay.com/photo/2016/10/26/13/09/bird-1771435_960_720.png",alt:"hello"})]})})}}]),a}(s.Component),ne=Object(j.b)((function(e){return{auth:e.auth,chat:e.chat}}),(function(e){return{setCurrentThread:function(t){e(function(e){return function(t){t({type:"SET_CURRENT_THREAD",payload:e})}}(t))}}}))(Object(h.g)(Object(M.a)((function(e){return{root:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},nested:{paddingLeft:e.spacing(4)}}}))(re))),ce=a(81),ie=a.n(ce),oe=a(80),le=a.n(oe),de=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={users:[]},e.getAllAvailableUsers=function(){try{e.props.chat.socket.send(JSON.stringify({type:"GET_ALL_CLIENTS",userId:e.props.auth.user.id}))}catch(t){}},e.createAGroup=function(){var t=e.state.users;t.push(e.props.auth.user.id);try{e.props.chat.socket.send(JSON.stringify({type:"CREATE_A_GROUP",users:t}))}catch(a){}},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(e){this.getAllAvailableUsers()}},{key:"render",value:function(){var e=this,t=this.props;return Object(b.jsxs)("div",{className:"group-creator",children:[Object(b.jsx)("div",{className:"thread-top-bar",children:Object(b.jsx)("div",{className:"thread-title",children:"Group Creator"})}),Object(b.jsxs)("div",{className:"settings-view",children:[Object(b.jsx)(P.a,{component:"nav","aria-labelledby":"nested-list-subheader",className:t.root,children:Object(b.jsx)(P.a,{component:"div",disablePadding:!0,children:this.props.chat.users.length>0?this.props.chat.users.map((function(a,s){return Object(b.jsxs)(G.a,{button:!0,className:t.nested,onClick:function(t){var s=e.state.users;e.state.users.filter((function(e){return e===a.userId})).length<1?(s.push(a.userId),e.setState({users:s})):(s=s.filter((function(e){return e!==a.userId})),e.setState({users:s}))},children:[""===a.avatar?Object(b.jsx)(y.a,{className:"settings-nickname-icon",children:Object(b.jsx)(D.a,{})}):Object(b.jsx)(y.a,{className:"settings-nickname-icon",src:a.avatar}),Object(b.jsxs)("div",{style:{display:"inline-flex",flexDirection:"row",justifyContent:"space-between",width:"100%",paddingTop:"10px"},children:[Object(b.jsx)(L.a,{primary:a.name}),Object(b.jsx)(q.a,{children:e.state.users.filter((function(e){return e===a.userId})).length>0?Object(b.jsx)(le.a,{}):Object(b.jsx)(ie.a,{})})]})]},s)})):Object(b.jsx)(G.a,{className:t.nested,style:{textAlign:"center"},children:Object(b.jsx)(L.a,{primary:"No Users Online :c"})})})}),Object(b.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:this.state.users.length>1?Object(b.jsx)("button",{className:"button",onClick:function(t){return e.createAGroup()},children:"Save"}):Object(b.jsxs)("div",{style:{textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(b.jsx)("div",{className:"button unselected",children:"Save"}),Object(b.jsx)("div",{style:{fontSize:"11px",fontStyle:"italic",color:"#888"},children:"Choose minimum 2"})]})})]})]})}}]),a}(s.Component),ue=Object(j.b)((function(e){return{auth:e.auth,chat:e.chat}}))(Object(h.g)(Object(M.a)((function(e){return{root:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},nested:{paddingLeft:e.spacing(4)}}}))(de))),he=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return Object(b.jsxs)("div",{className:"messenger-container",children:[Object(b.jsx)(C,{}),"/create-group"!==this.props.match.url?Object(b.jsx)(ne,{}):Object(b.jsx)(ue,{})]})}}]),a}(s.Component),je=Object(j.b)((function(e){return Object(p.a)(Object(p.a)({},e.auth),e.chat)}))(Object(h.g)(he)),pe=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={email:"",name:"",avatar:"",saved:!1},e.profileUpdate=function(){e.props.chat.socket.send(JSON.stringify({type:"PROFILE_DATA_UPDATED",profileId:e.props.auth.user.Profile.id,user:{email:e.state.email,name:e.state.name,avatar:e.state.avatar,id:e.props.auth.user.id}}))},e.tobase64=function(t){var a=new FileReader;a.readAsDataURL(t),a.onload=function(){e.setState({avatar:a.result})}},e.compression=function(t){new R.a(t,{quality:.5,success:function(t){e.tobase64(t)}})},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(e){this.setState({email:this.props.auth.user.Profile.email,name:this.props.auth.user.Profile.name,avatar:this.props.auth.user.Profile.avatar?this.props.auth.user.Profile.avatar:""})}},{key:"render",value:function(){var e=this;return Object(b.jsx)("div",{children:this.state.saved?Object(b.jsx)(h.a,{to:"/"}):Object(b.jsx)("div",{className:"container account",children:Object(b.jsx)("div",{className:"row",children:Object(b.jsx)("div",{className:"col-md-12",children:Object(b.jsxs)("div",{className:"form-wrapper",children:[Object(b.jsx)("h1",{children:"".concat(this.props.auth.user.Profile.name,"'s Profile")}),Object(b.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e.profileUpdate(),e.props.profileUpdate(e.state.name,e.state.email,e.state.avatar),e.setState({saved:!0})},children:[Object(b.jsxs)("div",{className:"account-row",children:[Object(b.jsxs)("div",{className:"account-col",children:[Object(b.jsxs)("div",{className:"form-group",style:{paddingTop:"20px"},children:[Object(b.jsx)("label",{children:"Your Name"}),Object(b.jsx)("input",{type:"text",className:"form-control",placeholder:"Name",value:this.state.name,onChange:function(t){e.setState({name:t.target.value})}})]}),Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"Your Email"}),Object(b.jsx)("input",{type:"email",className:"form-control",placeholder:"Email",value:this.state.email,onChange:function(t){e.setState({email:t.target.value})}})]})]}),Object(b.jsxs)("label",{style:{marginLeft:"8%"},className:"account-avatar",children:[Object(b.jsx)(K.a,{className:"edit-icon"}),""===this.state.avatar?Object(b.jsx)(D.a,{className:"account-avatar-icon"}):Object(b.jsx)(y.a,{src:this.state.avatar,alt:"Account avatar",className:"account-avatar-icon"}),Object(b.jsx)("input",{className:"MyFile",type:"file",onChange:function(t){return e.compression(t.target.files[0])},id:"file-input-thread",style:{opacity:"0",width:"0",height:"0"}})]})]}),Object(b.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Save"})]})]})})})})})}}]),a}(s.Component),be=Object(j.b)((function(e){return{auth:e.auth,chat:e.chat}}),(function(e){return{profileUpdate:function(t,a,s){e(function(e,t,a){return function(s){s({type:"NEW_PROFILE_DATA",payload:{name:e,email:t,avatar:a}})}}(t,a,s))}}}))(pe),me=(a(105),a(106),function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.props.setupSocket(this.props.auth.token,this.props.auth.user.id)}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e=this;return Object(b.jsx)("div",{className:"App",children:Object(b.jsx)(u.a,{children:Object(b.jsxs)(h.d,{children:[Object(b.jsx)(h.b,{path:"/account",render:function(t){return e.props.auth.token?Object(b.jsx)(be,{}):Object(b.jsx)(v,{})}}),Object(b.jsx)(h.b,{path:"/login",render:function(t){return e.props.auth.token?Object(b.jsx)(h.a,{to:"/"}):Object(b.jsx)(v,{})}}),Object(b.jsx)(h.b,{path:"/signup",render:function(t){return e.props.auth.token?Object(b.jsx)(h.a,{to:"/"}):Object(b.jsx)(v,{})},component:v}),Object(b.jsx)(h.b,{path:"/group/:threadId",render:function(t){return e.props.auth.token?Object(b.jsx)(je,{}):Object(b.jsx)(h.a,{to:"/login"})}}),Object(b.jsx)(h.b,{path:"/:threadId",render:function(t){return e.props.auth.token?Object(b.jsx)(je,{}):Object(b.jsx)(h.a,{to:"/login"})}}),Object(b.jsx)(h.b,{exact:!0,path:"/create-group",render:function(t){return e.props.auth.token?Object(b.jsx)(je,{}):Object(b.jsx)(h.a,{to:"/login"})}}),Object(b.jsx)(h.b,{exact:!0,path:"/",render:function(t){return e.props.auth.token?Object(b.jsx)(je,{}):Object(b.jsx)(h.a,{to:"/login"})}})]})})})}}]),a}(s.Component)),Oe=Object(j.b)((function(e){return{auth:e.auth,chat:e.chat}}),(function(e){return{setupSocket:function(t,a){e(function(e,t){return function(a){var s=new WebSocket("ws://localhost:8080");s.onopen=function(){e?(s.send(JSON.stringify({type:"CONNECT_WITH_TOKEN",data:{token:e,userId:t}})),a({type:"SETUP_SOCKET",payload:s})):a({type:"SETUP_SOCKET",payload:s})},s.onmessage=function(e){var t=JSON.parse(e.data);switch(t.type){case"LOGGEDIN":a(function(e){return function(t){t({type:"LOGGEDIN",payload:e})}}(t));break;case"GOT_USERS":a({type:"GOT_USERS",payload:t.data.users});break;case"ADD_THREAD":a({type:"ADD_THREAD",payload:t.data});break;case"INITIAL_THREADS":a({type:"INITIAL_THREADS",payload:t.data}),document.getElementById("main-view")?document.getElementById("main-view").scrollTop=document.getElementById("main-view").scrollHeight:console.log("could not find a component");break;case"GOT_MESSAGES":a({type:"ADD_MESSAGES_TO_THREAD",payload:{threadId:t.threadId,messages:t.messages}});break;case"ADD_MESSAGE_TO_THREAD":a({type:"ADD_SINGLE_MESSAGE",payload:{threadId:t.threadId,message:t.message}}),document.getElementById("main-view")?document.getElementById("main-view").scrollTop=document.getElementById("main-view").scrollHeight:console.log("could not find a component");break;case"THREAD_USERS_DATA_CHANGED":a({type:"THREAD_USERS_CHANGED",payload:{threadId:t.threadId,users:t.users}});break;case"THREAD_NAME_KEY_CHANGED":a({type:"NEW_THREAD_NAME",payload:{threadId:t.threadId,name:t.threadName}});break;case"THREAD_IMAGE_CHANGED":a({type:"NEW_THREAD_AVATAR",payload:{threadId:t.threadId,avatar:t.avatar}});break;case"PROFILE_UPDATED":a({type:"NEW_PROFILE_DATA",payload:{profile:t.profile,userId:t.userId}});break;case"CLIENTS_DATA":a({type:"ONLINE_CLIENTS_DATA",payload:{clients:t.clients}});break;case"NEW_GROUP_CREATED":a({type:"GROUP_CREATED",payload:t.thread})}}}}(t,a))},logout:function(){e((function(e){e({type:"LOGGEDOUT",payload:null})}))}}}))(me),fe=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,151)).then((function(t){var a=t.getCLS,s=t.getFID,r=t.getFCP,n=t.getLCP,c=t.getTTFB;a(e),s(e),r(e),n(e),c(e)}))},xe=a(29),ge=a(82),ve=a(66),ye=a(83),Ne=a.n(ye),Ee={token:null,user:{}},Ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGGEDIN":return Object(p.a)(Object(p.a)({},e),{},{token:t.payload.data.session.id,user:t.payload.data.user});case"LOGGEDOUT":return Object(p.a)(Object(p.a)({},e),Ee);case"NEW_PROFILE_DATA":return Object(p.a)(Object(p.a)({},e),{},{user:Object(p.a)(Object(p.a)({},e.user),{},{Profile:Object(p.a)(Object(p.a)({},e.user.Profile),{},{name:t.payload.name,email:t.payload.email,avatar:t.payload.avatar})})});default:return e}},Se={socket:null,message:"",threads:[],currentThread:{},users:[]},Te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SETUP_SOCKET":return Object(p.a)(Object(p.a)({},e),{},{socket:t.payload});case"GOT_USERS":return Object(p.a)(Object(p.a)({},e),{},{users:t.payload});case"ADD_THREAD":return Object(p.a)(Object(p.a)({},e),{},{threads:0===e.threads.filter((function(e){return e.id===t.payload.id})).length?e.threads.concat(t.payload):e.threads});case"INITIAL_THREADS":return Object(p.a)(Object(p.a)({},e),{},{threads:t.payload});case"ADD_SINGLE_MESSAGE":return Object(p.a)(Object(p.a)({},e),{},{threads:e.threads?e.threads.map((function(e){return e.id===t.payload.threadId?Object(p.a)(Object(p.a)({},e),{},{Messages:e.Messages?e.Messages.concat(t.payload.message):[t.payload.message]}):e})):[],currentThread:Object(p.a)(Object(p.a)({},e.currentThread),{},{Messages:e.currentThread.Messages?e.currentThread.Messages.concat(t.payload.message):[t.payload.message]})});case"ADD_MESSAGES_TO_THREAD":return Object(p.a)(Object(p.a)({},e),{},{threads:e.threads.forEach((function(e){if(e.id===t.payload.threadId)return Object(p.a)(Object(p.a)({},e),{},{Messages:t.payload.messages.concat(e.Messages)})}))});case"THREAD_USERS_CHANGED":return Object(p.a)(Object(p.a)({},e),{},{threads:e.threads.forEach((function(e){if(e.id===t.payload.threadId)return Object(p.a)(Object(p.a)({},e),{},{users:t.payload.users})}))});case"NEW_THREAD_NAME":return Object(p.a)(Object(p.a)({},e),{},{threads:e.threads.forEach((function(e){if(e.id===t.payload.threadId)return Object(p.a)(Object(p.a)({},e),{},{name:t.payload.name})}))});case"SET_CURRENT_THREAD":return Object(p.a)(Object(p.a)({},e),{},{currentThread:t.payload});case"NEW_THREAD_AVATAR":return Object(p.a)(Object(p.a)({},e),{},{threads:e.threads&&e.threads.forEach((function(e){if(e.id===t.payload.threadId)return Object(p.a)(Object(p.a)({},e),{},{image:t.payload.avatar})})),currentThread:Object(p.a)(Object(p.a)({},e.currentThread),{},{image:t.payload.avatar})});case"NEW_PROFILE_DATA":return Object(p.a)(Object(p.a)({},e),{},{users:e.users?e.users.forEach((function(e){if(e.id===t.payload.userId)return Object(p.a)(Object(p.a)({},e),{},{Profile:Object(p.a)(Object(p.a)({},e.Profile),{},{name:t.payload.profile.name,email:t.payload.profile.email,avatar:t.payload.profile.avatar})})})):[]});case"ONLINE_CLIENTS_DATA":return Object(p.a)(Object(p.a)({},e),{},{users:t.payload.clients});case"GROUP_CREATED":return Object(p.a)(Object(p.a)({},e),{},{threads:e.threads.concat(t.payload)});default:return e}},De=Object(xe.c)({auth:Ae,chat:Te}),Ie={key:"root",storage:Ne.a},we=Object(ve.a)(Ie,De);var ke=function(){var e=Object(xe.d)(we,Object(xe.a)(ge.a));return{store:e,persistor:Object(ve.b)(e)}},Ce=a(84),_e=ke(),Re=_e.store,Me=_e.persistor;c.a.render(Object(b.jsx)(j.a,{store:Re,children:Object(b.jsx)(Ce.a,{loading:null,persistor:Me,children:Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(Oe,{})})})}),document.getElementById("root")),fe()},97:function(e,t,a){}},[[109,1,2]]]);
//# sourceMappingURL=main.0053d956.chunk.js.map